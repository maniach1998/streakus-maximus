<div class="mb-6">
  <a href="/habits/{{habit._id}}" class="text-primary hover:text-primary/80"><- Back to habit</a>
      <div class="mt-4">
        <h1>{{habit.name}} Progress</h1>
        <p class="text-muted-foreground">Track your habit completion over time</p>
      </div>
</div>

<div class="mb-8">
  <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-2 lg:gap-0">
    <h2>Progress Overview</h2>
    <div class="flex gap-2">
      <a href="?timeframe=month"
        class="button {{#if (eq timeframe 'month')}}button-primary{{else}}button-secondary{{/if}}">
        Last 30 Days
      </a>
      <a href="?timeframe=year"
        class="button {{#if (eq timeframe 'year')}}button-primary{{else}}button-secondary{{/if}}">
        Last Year
      </a>
    </div>
  </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
  <div class="card">
    <h3 class="mb-4">Completion Rate</h3>
    <div class="h-64">
      <canvas id="completionChart"></canvas>
    </div>
  </div>

  <div class="card">
    <h3>Calendar View</h3>
    <p class="text-muted-foreground text-sm mb-4">Your habit completions over time</p>
    <div class="grid grid-cols-7 gap-1">
      {{#each calendarData}}
      <div
        class="aspect-square rounded-sm {{#if this.completed}}bg-primary{{else}}bg-muted{{/if}} hover:opacity-80 transition-opacity"
        title="{{this.date}}">
      </div>
      {{/each}}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Initialize completion rate chart
  const ctx = document.getElementById('completionChart');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{{ json completionRates }}}.map(rate => rate.label),
    datasets: [{
      label: 'Completions',
      data: {{{ json completionRates }}}.map(rate => rate.completions),
    backgroundColor: '#ffffff',
    borderRadius: 4
      }]
    },
    options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        ticks: {
          stepSize: 1
        }
      }
    }
  }
  });
</script>